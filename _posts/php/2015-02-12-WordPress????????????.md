---
layout: post
title: WordPress????????????
category: PHP
tags: ????,WordPress
keywords: ????,WordPress
description: 
---

WordPress????????????????????????????????????really static??????????????????????

?????????????????????????????????????????????????????????????????

????PHP???cache.php??????????

        &lt;?php
        define('CACHE_ROOT', dirname(__FILE__).'/cache');
        define('CACHE_LIFE', 86400);                   //?????????????86400????
        define('CACHE_SUFFIX','.html');             //????????????? .php .asp .jsp .pl ??
        
        $file_name  = md5($_SERVER['REQUEST_URI']).CACHE_SUFFIX;    //?????
        
        //???????md5???????????????????????????????????????????
        //256???????1000????????25?????????????65536*1000=??????
        //?????????1000????????
        
        $cache_dir  = CACHE_ROOT.'/'.substr($file_name,0,2);
        $cache_file = $cache_dir.'/'.$file_name;    //????????
        
        if($_SERVER['REQUEST_METHOD']=='GET'){      //GET????????POST??????????????
            if(file_exists($cache_file) &amp;&amp; time() - filemtime($cache_file) &lt; CACHE_LIFE){   //???????????????????????
                $fp = fopen($cache_file,'rb');
                fpassthru($fp);
                fclose($fp);
                exit();
            }
            elseif(!file_exists($cache_dir)){
                if(!file_exists(CACHE_ROOT)){
                    mkdir(CACHE_ROOT,0777);
                    chmod(CACHE_ROOT,0777);
                }
                mkdir($cache_dir,0777);
                chmod($cache_dir,0777);
            }
        
            function auto_cache($contents){         //??????????????????
                global $cache_file;
                $fp = fopen($cache_file,'wb');
                fwrite($fp,$contents);
                fclose($fp);
                chmod($cache_file,0777);
                clean_old_cache();                  //??????????????????????????
                return $contents;
            }
        
            function clean_old_cache(){
                chdir(CACHE_ROOT);
                foreach (glob("*/*".CACHE_SUFFIX) as $file){
                   if(time()-filemtime($file)&gt;CACHE_LIFE){
                       unlink($file);
                   }
                }
            }
        
            ob_start('auto_cache');                 //???? auto_cache
        }
        else{
            if(file_exists($cache_file)){           //file_exists() ??????????????
                unlink($cache_file);                //??GET???????????
            }
        }
        ?&gt;


????????cache?????cache???777??

        chmod -R 777 /var/www/webRoot/cache


???????index.php??&lt;?php?????

        require('cache.php');


?php??????????????????????????????

???????????????????????????

