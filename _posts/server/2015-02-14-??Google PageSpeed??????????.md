---
layout: post
title: ??Google PageSpeed??????????
category: ???
tags: PageSpeed,Google,??
keywords: PageSpeed,Google,??
description: 
---

PageSpeed?????????????????????????????????????"???"???????????????/??????????????????????????HTTP???????HTTP????????DNS??????

???ngx_pagespeed??????????????????????????[????][1]?


* Collapse Whitespace??????????HTML?????????????????????????
* Canonicalize JavaScript Libraries??????JavaScript???????????JavaScript????????JavaScript???????????????????
* Combine CSS???CSS???????CSS???????CSS?????HTTP?????
* Combine JavaScript???JavaScript???????JavaScript???????JavaScript?????HTTP?????
* Elide Attributes?????????????????????????????
* Extend Cache?????????????????????????????
* Flatten CSS Imports???CSS????????CSS????@import???HTTP???????
* Lazyload Images????????????????????????????
* Minify JavaScript???JavaScript??????JavaScript?????????
* Optimize Images???????????????????????????GIF?????PNG??????????
* Pre-Resolve DNS????DNS???????DNS???DNS?????
* Prioritize Critical CSS???????CSS??????CSS??????????????CSS???


????????Ubuntu????????????Ubuntu?????

??????????

        $ sudo apt-get install build-essential zlib1g-dev libpcre3-dev


?????ngx_pagespeed?????????`ngx_pagespeed`??????`/usr/local/nginx/modules/ngx_pagespeed-1.7.30.3-beta`???????????`/usr/local/src`???

        $ cd /usr/local/src/
        
        $ wget https://github.com/pagespeed/ngx_pagespeed/archive/v1.7.30.3-beta.tar.gz
        
        $ sudo tar xvfvz v1.7.30.3-beta.tar.gz


??????PSOL?PageSpeed????https://developers.google.com/speed/pagespeed/psol??/usr/local/src/???????ngx_pagespeed??

        $ wget https://dl.google.com/dl/page-speed/psol/1.7.30.3.tar.gz
        
        $ sudo tar xvfvz 1.7.30.3.tar.gz -C /usr/local/src/ngx_pagespeed-1.7.30.3-beta --no-same-owner
        
        $ sudo find /usr/local/src/ngx_pagespeed-1.7.30.3-beta/ -type d -exec chmod +rx {} \;
        
        $ sudo find /usr/local/src/ngx_pagespeed-1.7.30.3-beta/ -type f -exec chmod +r {} \;


Nginx??Apache???????????Nginx????????????????Nginx?????

        $ /usr/local/nginx/nginx -V
        
        nginx version: nginx/1.4.4
        
        built by gcc 4.8.2 20131212 (Red Hat 4.8.2-7) (GCC)
        
        configure arguments: ......


????????Nginx???????????nginx??????

        $ wget http://nginx.org/download/nginx-1.4.4.tar.gz


????ngx_pagespeed??????????????--add-module=....ngx_pagespeed?????????????make?????????Nginx(??????nginx????copy????ngx_pagespeed??)???????????

        $ tar xvfvz nginx-1.4.4.tar.gz
        
        $ cd nginx-1.4.4
        
        $ ./configure --add-module=/usr/local/nginx/modules/ngx_pagespeed-1.7.30.3-beta --prefix=/usr/local/nginx --sbin-path=/usr/local/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/run/nginx.pid --lock-path=/run/lock/subsys/nginx --user=nginx --group=nginx 
        
        $ make
        
        $ sudo make install


????ngx_pagespeed???????????Nginx?????????

        $ /usr/local/nginx/nginx -V
        
        nginx version: nginx/1.4.4
        
        built by gcc 4.8.2 20131212 (Red Hat 4.8.2-7) (GCC)
        
        configure arguments: --add-module=/usr/local/nginx/modules/ngx_pagespeed-1.7.30.3-beta . . . .


???nginx.conf??PageSpeed???PageSpeed??????????????CoreFilters?PassThrough?????????????????CoreFilters???????????CoreFilters??????

        server {
        
        # ?????
        
        listen 80;
        
        # ?????
        
        server_name gitdc.com www.gitdc.com;
        
        # ?????
        
        root /var/www;
        
        # ????
        
        access_log /var/log/nginx/access.log main;
        
        # ??ngx_pagespeed
        
        pagespeed on;
        
        pagespeed FileCachePath /var/ngx_pagespeed_cache;
        
        # ??CoreFilters
        
        pagespeed RewriteLevel CoreFilters;
        
        # ??CoreFilters???????
        
        pagespeed DisableFilters rewrite_images;
        
        # ????????????
        
        pagespeed EnableFilters collapse_whitespace;
        
        pagespeed EnableFilters lazyload_images;
        
        pagespeed EnableFilters insert_dns_prefetch;
        
        }


??????PageThrough???????????????????

        server {
        
        # ?????
        
        listen 80;
        
        # ?????
        
        server_name gitdc.com www.gitdc.com;
        
        # ?????
        
        root /var/www;
        
        # ????
        
        access_log /var/log/nginx/access.log main;
        
        # ??ngx_pagespeed
        
        pagespeed on;
        
        pagespeed FileCachePath /var/ngx_pagespeed_cache;
        
        # ??CoreFilters
        
        pagespeed RewriteLevel PassThrough;
        
        # ?????????
        
        pagespeed EnableFilters collapse_whitespace;
        
        # ??JavaScript???
        
        pagespeed EnableFilters canonicalize_javascript_libraries;
        
        # ???CSS???????CSS??
        
        pagespeed EnableFilters combine_css;
        
        # ???JavaScript???????JavaScript??
        
        pagespeed EnableFilters combine_javascript;
        
        # ??????????
        
        pagespeed EnableFilters elide_attributes;
        
        # ?????????
        
        pagespeed EnableFilters extend_cache;
        
        # ????????@import???CSS??
        
        pagespeed EnableFilters flatten_css_imports;
        
        pagespeed CssFlattenMaxBytes 5120;
        
        # ?????????????
        
        pagespeed EnableFilters lazyload_images;
        
        # ??JavaScript????
        
        pagespeed EnableFilters rewrite_javascript;
        
        # ????????
        
        pagespeed EnableFilters rewrite_images;
        
        # ???DNS??
        
        pagespeed EnableFilters insert_dns_prefetch;
        
        # ??CSS??????????CSS??
        
        pagespeed EnableFilters prioritize_critical_css;
        
        }


????????

????Nginx????????????

        $ sudo mkdir /var/ngx_pagespeed_cache
        
        $ sudo chown nginx:nginx /var/ngx_pagespeed_cache


???????????????????????nginx.conf??????????????

????nginx

        $ /usr/local/nginx/nginx -s reload


 


[1]: http://ngxpagespeed.com/ngx_pagespeed_example/
